<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Rhiz - Relationship Intelligence</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        :root {
            --bs-dark: #1a1a2e;
            --bs-primary: #4facfe;
            --bs-secondary: #8b5cf6;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
        }
        
        .glass-button {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .glass-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #4facfe 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .navbar {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.7) !important;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover,
        .nav-link.active {
            color: #ffffff !important;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        
        .loading-spinner {
            width: 2rem;
            height: 2rem;
            border: 2px solid transparent;
            border-top: 2px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // API service
        const api = {
            async get(endpoint) {
                const response = await fetch(`/api${endpoint}`, {
                    credentials: 'include'
                });
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                return response.json();
            },
            
            async post(endpoint, data) {
                const response = await fetch(`/api${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify(data)
                });
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                return response.json();
            }
        };
        
        // Router hook
        function useRouter() {
            const [currentPath, setCurrentPath] = useState(window.location.pathname);
            
            useEffect(() => {
                const handlePopState = () => setCurrentPath(window.location.pathname);
                window.addEventListener('popstate', handlePopState);
                return () => window.removeEventListener('popstate', handlePopState);
            }, []);
            
            const navigate = (path) => {
                window.history.pushState({}, '', path);
                setCurrentPath(path);
            };
            
            return { currentPath, navigate };
        }
        
        // Navigation Component
        function Navigation({ currentPath, navigate, user }) {
            const navItems = [
                { path: '/app/dashboard', icon: 'house', label: 'Home' },
                { path: '/app/goals', icon: 'bullseye', label: 'Goals' },
                { path: '/app/contacts', icon: 'people', label: 'Contacts' },
                { path: '/app/network', icon: 'diagram-3', label: 'Network' },
                { path: '/app/intelligence', icon: 'cpu', label: 'Intelligence' },
                { path: '/app/settings', icon: 'gear', label: 'Settings' }
            ];
            
            return (
                <nav className="navbar navbar-expand-lg navbar-dark">
                    <div className="container-fluid">
                        <a 
                            className="navbar-brand gradient-text fw-bold fs-4" 
                            href="#"
                            onClick={(e) => { e.preventDefault(); navigate('/app/dashboard'); }}
                        >
                            Rhiz
                        </a>
                        
                        <div className="d-flex align-items-center">
                            <div className="d-none d-md-flex me-4">
                                {navItems.map(item => (
                                    <a
                                        key={item.path}
                                        href="#"
                                        className={`nav-link px-3 py-2 me-2 ${currentPath === item.path ? 'active' : ''}`}
                                        onClick={(e) => {
                                            e.preventDefault();
                                            navigate(item.path);
                                        }}
                                    >
                                        <i className={`bi bi-${item.icon} me-2`}></i>
                                        {item.label}
                                    </a>
                                ))}
                            </div>
                            
                            {user && (
                                <div className="d-flex align-items-center">
                                    <span className="text-white-50 me-3 d-none d-sm-inline">
                                        {user.email}
                                    </span>
                                    <button
                                        className="btn btn-outline-light btn-sm"
                                        onClick={() => {
                                            fetch('/api/auth/logout', { method: 'POST', credentials: 'include' })
                                                .then(() => window.location.href = '/');
                                        }}
                                    >
                                        <i className="bi bi-box-arrow-right"></i>
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </nav>
            );
        }
        
        // Dashboard Component
        function Dashboard() {
            const [stats, setStats] = useState(null);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                Promise.all([
                    api.get('/goals'),
                    api.get('/contacts'),
                    api.get('/insights')
                ]).then(([goals, contacts, insights]) => {
                    setStats({
                        totalGoals: goals.length,
                        totalContacts: contacts.length,
                        aiSuggestions: insights.suggestions?.length || 0,
                        trustScore: 85
                    });
                    setLoading(false);
                }).catch(error => {
                    console.error('Error loading dashboard:', error);
                    setLoading(false);
                });
            }, []);
            
            if (loading) {
                return (
                    <div className="d-flex justify-content-center align-items-center" style={{ height: '400px' }}>
                        <div className="loading-spinner"></div>
                        <span className="ms-3">Loading your dashboard...</span>
                    </div>
                );
            }
            
            return (
                <div className="container-fluid py-4">
                    <div className="row mb-4">
                        <div className="col">
                            <h1 className="gradient-text fw-bold mb-2">Welcome back</h1>
                            <p className="text-white-50">Here's what's happening with your network</p>
                        </div>
                    </div>
                    
                    <div className="row g-4 mb-4">
                        {stats && [
                            { label: 'Active Goals', value: stats.totalGoals, icon: 'bullseye', color: '#4facfe' },
                            { label: 'Contacts', value: stats.totalContacts, icon: 'people', color: '#8b5cf6' },
                            { label: 'AI Suggestions', value: stats.aiSuggestions, icon: 'cpu', color: '#ec4899' },
                            { label: 'Trust Score', value: `${stats.trustScore}%`, icon: 'shield-check', color: '#10b981' }
                        ].map((stat, index) => (
                            <div key={index} className="col-md-3">
                                <div className="glass-card p-4 h-100">
                                    <div className="d-flex align-items-center">
                                        <div 
                                            className="rounded-circle p-3 me-3"
                                            style={{ backgroundColor: `${stat.color}20`, border: `1px solid ${stat.color}40` }}
                                        >
                                            <i className={`bi bi-${stat.icon} fs-4`} style={{ color: stat.color }}></i>
                                        </div>
                                        <div>
                                            <div className="h3 fw-bold mb-0 text-white">{stat.value}</div>
                                            <div className="text-white-50 small">{stat.label}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                    
                    <div className="row g-4">
                        <div className="col-lg-6">
                            <div className="glass-card p-4">
                                <h5 className="text-white mb-3">
                                    <i className="bi bi-bullseye me-2"></i>
                                    Recent Goals
                                </h5>
                                <div className="text-center py-4">
                                    <i className="bi bi-plus-circle fs-1 text-white-50 mb-3"></i>
                                    <p className="text-white-50">Create your first goal to get started</p>
                                    <button className="btn btn-primary glass-button">
                                        <i className="bi bi-plus me-2"></i>
                                        Add Goal
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div className="col-lg-6">
                            <div className="glass-card p-4">
                                <h5 className="text-white mb-3">
                                    <i className="bi bi-cpu me-2"></i>
                                    AI Insights
                                </h5>
                                <div className="text-center py-4">
                                    <i className="bi bi-lightbulb fs-1 text-white-50 mb-3"></i>
                                    <p className="text-white-50">AI suggestions will appear here</p>
                                    <button className="btn btn-outline-light glass-button">
                                        <i className="bi bi-arrow-clockwise me-2"></i>
                                        Refresh Insights
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Goals Component
        function Goals() {
            return (
                <div className="container-fluid py-4">
                    <div className="row mb-4">
                        <div className="col">
                            <h1 className="gradient-text fw-bold mb-2">Goals</h1>
                            <p className="text-white-50">Define and track your relationship objectives</p>
                        </div>
                    </div>
                    
                    <div className="glass-card p-4">
                        <div className="text-center py-5">
                            <i className="bi bi-bullseye fs-1 text-white-50 mb-3"></i>
                            <h4 className="text-white mb-3">Your Goals Dashboard</h4>
                            <p className="text-white-50 mb-4">Create and manage your relationship goals here</p>
                            <button className="btn btn-primary glass-button">
                                <i className="bi bi-plus me-2"></i>
                                Create First Goal
                            </button>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Contacts Component
        function Contacts() {
            return (
                <div className="container-fluid py-4">
                    <div className="row mb-4">
                        <div className="col">
                            <h1 className="gradient-text fw-bold mb-2">Contacts</h1>
                            <p className="text-white-50">Manage your professional network</p>
                        </div>
                    </div>
                    
                    <div className="glass-card p-4">
                        <div className="text-center py-5">
                            <i className="bi bi-people fs-1 text-white-50 mb-3"></i>
                            <h4 className="text-white mb-3">Your Contact Network</h4>
                            <p className="text-white-50 mb-4">Import and manage your professional contacts</p>
                            <button className="btn btn-primary glass-button">
                                <i className="bi bi-plus me-2"></i>
                                Add Contacts
                            </button>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Intelligence Component
        function Intelligence() {
            return (
                <div className="container-fluid py-4">
                    <div className="row mb-4">
                        <div className="col">
                            <h1 className="gradient-text fw-bold mb-2">Intelligence</h1>
                            <p className="text-white-50">AI-powered relationship insights</p>
                        </div>
                    </div>
                    
                    <div className="glass-card p-4">
                        <div className="text-center py-5">
                            <i className="bi bi-cpu fs-1 text-white-50 mb-3"></i>
                            <h4 className="text-white mb-3">Relationship Intelligence</h4>
                            <p className="text-white-50 mb-4">Get AI-powered insights about your network</p>
                            <button className="btn btn-primary glass-button">
                                <i className="bi bi-arrow-clockwise me-2"></i>
                                Generate Insights
                            </button>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Onboarding Component
        function Onboarding({ navigate }) {
            const [currentStep, setCurrentStep] = useState(1);
            const [selectedIntent, setSelectedIntent] = useState('');
            
            const intents = [
                { value: 'fundraising', label: 'ðŸ’° Fundraising', description: 'Connect with investors and raise capital' },
                { value: 'hiring', label: 'ðŸ‘¥ Hiring', description: 'Find and recruit talented team members' },
                { value: 'partnerships', label: 'ðŸ¤ Partnerships', description: 'Build strategic business partnerships' },
                { value: 'community', label: 'ðŸŒŸ Community Building', description: 'Build and engage your professional community' }
            ];
            
            const handleNext = () => {
                if (currentStep < 4) {
                    setCurrentStep(currentStep + 1);
                } else {
                    navigate('/app/dashboard');
                }
            };
            
            return (
                <div className="container py-5">
                    <div className="row justify-content-center">
                        <div className="col-lg-8">
                            <div className="glass-card p-5">
                                <div className="mb-4">
                                    <div className="progress mb-3" style={{ height: '8px' }}>
                                        <div 
                                            className="progress-bar bg-primary" 
                                            style={{ width: `${(currentStep / 4) * 100}%` }}
                                        ></div>
                                    </div>
                                    <div className="text-center">
                                        <span className="text-white-50">Step {currentStep} of 4</span>
                                    </div>
                                </div>
                                
                                {currentStep === 1 && (
                                    <div className="text-center">
                                        <h2 className="gradient-text fw-bold mb-3">Welcome to Rhiz</h2>
                                        <p className="text-white-50 mb-4">Let's set up your relationship intelligence platform</p>
                                        <p className="text-white mb-4">What's your primary goal for using Rhiz?</p>
                                        
                                        <div className="row g-3 mb-4">
                                            {intents.map(intent => (
                                                <div key={intent.value} className="col-md-6">
                                                    <div 
                                                        className={`glass-card p-3 cursor-pointer h-100 ${selectedIntent === intent.value ? 'border-primary' : ''}`}
                                                        onClick={() => setSelectedIntent(intent.value)}
                                                        style={{ cursor: 'pointer' }}
                                                    >
                                                        <h6 className="text-white mb-2">{intent.label}</h6>
                                                        <p className="text-white-50 small mb-0">{intent.description}</p>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                        
                                        <button 
                                            className="btn btn-primary glass-button px-4"
                                            onClick={handleNext}
                                            disabled={!selectedIntent}
                                        >
                                            Continue
                                        </button>
                                    </div>
                                )}
                                
                                {currentStep > 1 && (
                                    <div className="text-center">
                                        <h3 className="gradient-text fw-bold mb-3">Setup Complete!</h3>
                                        <p className="text-white-50 mb-4">Your Rhiz platform is ready to use</p>
                                        <button 
                                            className="btn btn-primary glass-button px-4"
                                            onClick={() => navigate('/app/dashboard')}
                                        >
                                            Go to Dashboard
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Main App Component
        function App() {
            const { currentPath, navigate } = useRouter();
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                api.get('/auth/me')
                    .then(setUser)
                    .catch(console.error)
                    .finally(() => setLoading(false));
            }, []);
            
            if (loading) {
                return (
                    <div className="d-flex justify-content-center align-items-center min-vh-100">
                        <div className="text-center">
                            <div className="loading-spinner mb-3"></div>
                            <p className="text-white-50">Loading Rhiz...</p>
                        </div>
                    </div>
                );
            }
            
            const renderPage = () => {
                if (currentPath.includes('onboarding')) {
                    return <Onboarding navigate={navigate} />;
                } else if (currentPath.includes('goals')) {
                    return <Goals />;
                } else if (currentPath.includes('contacts')) {
                    return <Contacts />;
                } else if (currentPath.includes('intelligence')) {
                    return <Intelligence />;
                } else {
                    return <Dashboard />;
                }
            };
            
            return (
                <div className="min-vh-100">
                    <Navigation currentPath={currentPath} navigate={navigate} user={user} />
                    {renderPage()}
                </div>
            );
        }
        
        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>